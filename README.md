# Операционные системы UNIX/Linux (Базовый).

Установка и обновления системы Linux. Основы администрирования.

### Администрирование

`-` Администрирование - это, если не вдаваться в подробности, поддержка и улучшение работы всего компьютерного и офисного оборудования, периферийных устройств, сетевого подключения и т.д. При администрировании Linux большая часть работы протекает в терминале, поэтому стоит начать с использования базовых утилит.

### Виртуальные машины

`-` Виртуальная машина (VM, ВМ) также, как и физические компьютеры, имеет ЦП, память, диски для хранения файлов и при необходимости может подключаться к Интернету. Отличие лишь в том, что компоненты вашего компьютера (аппаратная часть) материальны, а виртуальные машины существуют только в виде кода.

`-` Проще говоря, это виртуальный компьютер, на который можно устанавливать операционную систему и все сопутствующее программное обеспечение, при этом никаких изменений в Вашей основной операционной системе не будет.

`-` Виртуализация — это процесс создания программной (виртуальной) версии компьютера с выделенными ресурсами ЦП, памяти и хранилища, которые "заимствуются" у физического компьютера. Виртуальная машина — это компьютерный файл (образ), который действует как обычный компьютер.

`-` В свою очередь _VirtualBox_ - это программный продукт виртуализации, т.е. инструмент для создания виртуальных машин.

## Part 1. Установка ОС

- Узнайте версию Ubuntu, выполнив команду \
`cat /etc/issue.`

Установила версию Ubuntu, проверяю в терминале: 


![проверка ubuntu](screenshoots/part_1/p1_task1.PNG)

## Part 2. Создание пользователя

- Создаю пользователя noizemc через команду `sudo adduser noizemc`


![создание пользователя](screenshoots/part_2/p2_task_1.PNG)

- Добавляю пользователя в группу adm через команду `sudo usermod -a -G adm noizemc`

- Проверяю нахождение пользователя в группе adm через команду `groups noizemc`


![добавление в adm + проверка](screenshoots/part_2/p2_task_2.PNG)

- Вывожу команду `cat /etc/passwd`


![добавление в adm + проверка](screenshoots/part_2/p2_task_3.PNG)
![вывод команды passwd](screenshoots/part_2/p2_task_4.PNG)

## Part 3. Настройка сети ОС
Задание 3.1
##### Задать название машины вида user-1  
- Вывожу мое старое имя 


![старое имя](screenshoots/part_3/p3_task_1.PNG)

- Задаю название машины вида user-1 через редакцию файла `/etc/hostname` и файл `/etc/hosts` через команды `sudo nano /etc/hostname`


![команда ввод](screenshoots/part_3/p3_task_1_1_2.PNG)
![меняю имя в файле на user-1](screenshoots/part_3/p3_task_1_1.PNG)

- Делаю reboot машины чтобы обновить имя


![reboot машины для обновления имени](screenshoots/part_3/p3_task_1_2.PNG)

- Новое имя машины


![новое имя машины](screenshoots/part_3/p3_task_1_3.PNG)

Задание 3.2
##### Установить временную зону, соответствующую вашему текущему местоположению.  

- Открываю лист со всеми временными зонами через команду `timedatectl list-timezones`

- Устанавливаю временную зону через команду:`timedatectl set-timezone Europe/Moscow`

- Проверяю как установлена временная зона через команду `timedatectl`


![временная зона две команды](screenshoots/part_3/p3_task_2.jpg)

Задание 3.3
##### Вывести названия сетевых интерфейсов с помощью консольной команды.
Сетевой интерфейс (сетевой адаптер) — это часть аппаратного устройства, которая позволяет операционным системам и программам передавать данные через компьютерную сеть. Сетевой интерфейс является частью сетевой карты, маршрутизатора, коммутатора и других устройств.

- Вывожу названия сетевых интерфейсов с помощью консольной команды `ip -br link show`


![вывод сетевых интерфейсов](screenshoots/part_3/p3_task_3_1.PNG)

- Объяснение наличия интерфейса lo

lo (loopback device) – виртуальный интерфейс, присутствующий по умолчанию в любом Linux. Он используется для отладки сетевых программ и запуска серверных приложений на локальной машине. У него есть dns-имя – localhost. Посмотреть привязку можно в файле /etc/hosts. 

lo ― локальная петля. Служит для подключения по сети к этому же компьютеру и не требует дополнительной настройки; enp0s3 ― сетевой адаптер Ethernet.

Интерфейс lo обычно имеет IP-адрес 127.0.0.1 и позволяет программам на компьютере обращаться к себе через сетевой стек, что удобно для тестирования и отладки программ, а также для обмена данными между различными процессами на вашем компьютере.

Задание 3.4
##### Используя консольную команду получить ip адрес устройства, на котором вы работаете, от DHCP сервера.

- Вывожу ip моего компьютера спомощью команды `hostname -I`


![мой ip](screenshoots/part_3/p3_task_3_4.PNG)

- Расшифровка DHCP:
Dynamic Host Configuration Protocol (DHCP) — это сетевой протокол, который позволяет автоматически назначать подключаемым к сети устройствам IP-адреса и другие параметры конфигурации. Он упрощает управление и снижает вероятность конфликтов — назначения двум устройствам одного и того же адреса. IP-адрес можно назначать вручную каждому клиенту, то есть компьютеру в локальной сети.

Задание 3.5
##### Определить и вывести на экран внешний ip-адрес шлюза (ip) и внутренний IP-адрес шлюза, он же ip-адрес по умолчанию (gw). 

- Вывожу внутренний и внешний ip шлюза через команду `ip route | grep default`
- Внутренний по умолчанию (gw): 10.0.2.2
- Внешний (ip): 10.0.2.15
(больше обрезать не получилось, см нижний вариант в скрине)


![вывод шлюзов](screenshoots/part_3/p3_task_5.PNG)

Задание 3.6
##### Задать статичные (заданные вручную, а не полученные от DHCP сервера) настройки ip, gw, dns (использовать публичный DNS серверы, например 1.1.1.1 или 8.8.8.8).
- открываю файл с расширением .yaml


![файл yaml](screenshoots/part_3/p3_task_6_1.PNG)

- Редактирую и устанавливаю настройки 


![меняю настройки](screenshoots/part_3/p3_task_6_2.PNG)
-gw: 10.0.2.2
-dns: [1.1.1.1, 8.8.8.8]
-ip[10.0.2.21/24]

- Сохраняю и принимаю изменения сетевых настроек через команду sudo netplan apply


![принимаю изменения](screenshoots/part_3/p3_task_6_3.PNG)

Задание 3.7
##### Перезагрузить виртуальную машину. Убедиться, что статичные сетевые настройки (ip, gw, dns) соответствуют заданным в предыдущем пункте.  

- Перезапускаю виртуальную машину


![ребут](screenshoots/part_3/p3_task_7_1.PNG)

- Убеждаюсь через команду ifconfig, что сетевые настройки сохранились после ребута:

![проверяю ip после перезагрузки](screenshoots/part_3/p3_task_7_2.PNG)

Задание 3.7
- Пингую удаленные хосты 1.1.1.1 и ya.ru


![пингую яндекс](screenshoots/part_3/p3_task_8_1.PNG)
![пингую 1.1.1.1](screenshoots/part_3/p3_task_8_1.PNG)

## Part 4. Обновление ОС

Задание 4.1
##### Обновить системные пакеты до последней на момент выполнения задания версии.  
- Обновляю системные пакеты до последней версии через команду `sudo apt update`


![update](screenshoots/part_4/p4_task_1.PNG)

Задание 4.2
- Ввожу команду повторно чтобы убедиться что обновление прошло успешно


![проверка обновы](screenshoots/part_4/p4_task_2.PNG)


## Part 5. Использование команды **sudo**
Задание 5.1
##### Разрешить пользователю, созданному в [Part 2], выполнять команду sudo.

- Создаю папку для передачи прав sudo через команду  `sudo touch`


![папка](screenshoots/part_5/p5_task_1.PNG)

- Даю пользователю noizemc права пользователя sudo через команду usermod -a -G sudo noizemc


![sudo](screenshoots/part_5/p5_task_1_1.PNG)

- Проверяю может ли пользователь использовать команду sudo


![провека sudo](screenshoots/part_5/p5_task_1_2.PNG)

Задание 5.2
- Значение команды sudo:
Исторически первой была команда su.

su (сокр. от Substitute User, Set UID, Switch User, Super User — замена пользователя, переключение пользователя, суперпользователь) — команда, позволяющая пользователю войти в систему под другим именем, не завершая текущий сеанс. Обычно используется для временного входа суперпользователем для выполнения административных работ. Запущенная без параметров, она запрашивает пароль суперпользователя, и в случае успеха просто подменяет текущее имя пользователя на root, оставляя почти все переменные окружения от старого пользователя (кроме PATH, USER и еще пары-тройки). 

sudo (substitute user and do, дословно «подменить пользователя и выполнить») — программа для системного администрирования UNIX-систем, позволяющая делегировать те или иные привилегированные ресурсы пользователям с ведением протокола работы.
Программа sudo настраивается через файл /etc/sudoers.

В Debian-based-дистрибутивах пользователь root не имеет пароля, вместо этого все административные действия должны производиться через sudo.

При использовании sudo пользователь вводит свой пароль, а не пароль root'а.
По умолчанию sudo записывает всю пользовательскую активность в лог.
в sudo администратор системы может ограничить команды, выполняемые пользователями.
Если пользователь должен быть лишен права администрирования, в случае с su он должен забыть пароль root'а; если используется sudo, достаточно вынести его из соответствующей группы.
sudo может запоминать факт правильно введённого пароля и не спрашивать в дальнейшем. В Ubuntu пароль запоминается на 15 минут. Это тоже можно настроить. Программа sudo хранит свои служебные данные в каталоге /var/run/sudo/.

Задание 5.3
- Поменять hostname ОС от имени пользователя, созданного в пункте [Part 2](#part-2-создание-пользователя) (используя sudo).
- Через команду  `sudo nano /etc/hostname` редактирую файл названия виртуальной машины
- Делаю ребут 
- Новое название


![вывод даты](screenshoots/part_5/p5_task_3_1.PNG)
![вывод даты](screenshoots/part_5/p5_task_3_2.PNG)
![вывод даты](screenshoots/part_5/p5_task_3_3.PNG)



## Part 6. Установка и настройка службы времени

Задание 6.1
##### Настроить службу автоматической синхронизации времени.  

- Вывожу время часового пояса, в котором нахожусь через команду `date`


![вывод даты](screenshoots/part_6/p6_task_1_1.PNG)

- Устанавливаю ntpd через команду `sudo apt install -y ntp`


![установка](screenshoots/part_6/p6_task_1_2.PNG)

- Обовляю машину через update


![update](screenshoots/part_6/p6_task_1_3.PNG)

- Смотрю все списки времени, к которым подключена машина, через команду
`ntpq -p`


![списки времени](screenshoots/part_6/p6_task_1_4.PNG)

- Останавливаю ntp демона через команду `sudo systemctl stop ntp`


![стоп](screenshoots/part_6/p6_task_1_5.PNG)

- Принудительно синхронизирую время через команду `sudo ntpd -gq`


![время](screenshoots/part_6/p6_task_1_6.PNG)

- Запускаю ntp через команду `sudo systemctl start ntp`
- Проверяю статус через команду `sudo systemctl status ntp`


![время](screenshoots/part_6/p6_task_1_7.PNG)

- Вывожу команду `timedatectl` для проверки


![время](screenshoots/part_6/p6_task_1_8.PNG)

## Part 7. Установка и использование текстовых редакторов

Задание 7.1
##### Установить текстовые редакторы **VIM** (+ любые два по желанию **NANO**, **MCEDIT**, **JOE** и т.д.)

- Устанавливаю vim через команду  `sudo apt install vim`


![vim](screenshoots/part_7/p7_task_1.PNG)

- Устанавливаю mcedit через команду `sudo apt install mcedit`


![vim](screenshoots/part_7/p7_task_1_2.PNG)

Задание 7.2
##### Используя каждый из трех выбранных редакторов, создайте файл *test_X.txt*, где X -- название редактора, в котором создан файл. Напишите в нём свой никнейм, закройте файл с сохранением изменений. 

- Создаю текстовый документ в vim test_vim.txt, где пишу свой никнейм. Для сохранения использую комбинацию клавиш: `:wq`


![kristofs](screenshoots/part_7/p7_task_2_vim.PNG)
![save vim kris](screenshoots/part_7/p7_task_2_vim_1.PNG)

- Создаю текстовый документ в mcedit test_mcedit.txt, где пишу свой никнейм. Для сохранения использую комбинацию клавиш: `F2`


![kristofs](screenshoots/part_7/p7_task_2_mc.PNG)
![save mc kris](screenshoots/part_7/p7_task_2_mc_1.PNG)

- Создаю текстовый документ в nano test_nano.txt, где пишу свой никнейм. Для сохранения использую комбинацию клавиш: `Ctrl + O`


![kristofs](screenshoots/part_7/p7_task_2_nano.PNG)

Задание 7.3
##### Используя каждый из трех выбранных редакторов, откройте файл на редактирование, отредактируйте файл, заменив никнейм на строку "21 School 21", закройте файл без сохранения изменений.

- Редактирую текстовый документ в vim test_vim.txt, заменяю на "21 School 21". Для выхода БЕЗ сохранения использую комбинацию клавиш: `:q`


![kristofs](screenshoots/part_7/p7_task_3_vim.PNG)
![save vim kris](screenshoots/part_7/p7_task_3_vim_1.PNG)

- Создаю текстовый документ в mcedit test_mcedit.txt, заменяю на "21 School 21". Для выхода БЕЗ сохранения использую комбинацию клавиш: `F10`


![kristofs](screenshoots/part_7/p7_task_3_mc.PNG)

- Создаю текстовый документ в nano test_nano.txt, заменяю на "21 School 21". Для выхода БЕЗ сохранения использую комбинацию клавиш: `Ctrl + X`


![kristofs](screenshoots/part_7/p7_task_3_nano.PNG)

Задание 7.4
##### Используя каждый из трех выбранных редакторов, отредактируйте файл ещё раз (по аналогии с предыдущим пунктом), а затем освойте функции поиска по содержимому файла (слово) и замены слова на любое другое.

Поиск по содержимому: 

- Поиск по слову в vim производится через символ  `/`, открывается строка где можно написать искомое слово, после этого следует нажать `Enter` и курсор передвинется на искомое слово


![find a word](screenshoots/part_7/p7_task_4_vim.PNG)
![find a word](screenshoots/part_7/p7_task_4_vim_1.PNG)

- Поиск по слову в mcedit производится через клавишу `F7`, после чего открывается окно где можно выбрать слово или строку для поиска и указать параметры, по которым будет проводиться поиск


![find a word](screenshoots/part_7/p7_task_4_mc.PNG)
![find a word](screenshoots/part_7/p7_task_4_mc_1.PNG)

- Поиск по слову в nano производится через клавишу `Ctrl + W` для поиска начиная от курсора к концу файла, `Ctrl + Q` для поиска начиная от курсора к началу файла, после чего появляется строка, где можно написать искомое слово


![find a word](screenshoots/part_7/p7_task_4_nano.PNG)
![find a word](screenshoots/part_7/p7_task_4_nano_1.PNG)

Замена слова на любое другое:

- Замена слова в vim происходит через комбинацию клавиш `:s/старое/новое`


![change a word](screenshoots/part_7/p7_task_4_vim_2.PNG)

- Замена слова в mcedit происходит через клавишу `F4`


![change a word](screenshoots/part_7/p7_task_4_mc_2.PNG)
![change a word](screenshoots/part_7/p7_task_4_mc_2_1.PNG)
![change a word](screenshoots/part_7/p7_task_4_mc_2_2.PNG)

- Замена слова в nano происходит через комбинацию клавиш `Ctrl+\`
После чего введите строку, которую необходимо искать и нажмите клавишу Enter. Затем введите строку, на которую произвести замену и нажмите Enter.


![change a word](screenshoots/part_7/p7_task_4_nano_2_1.PNG)
![change a word](screenshoots/part_7/p7_task_4_nano_2_2.PNG)
![change a word](screenshoots/part_7/p7_task_4_nano_2_3.PNG)

## Part 8. Установка и базовая настройка сервиса **SSHD**
Задание 8.1
##### Установить службу SSHd.  
- Устанавливаю службу SSHd через команду `sudo apt-get install ssh`


![sshd](screenshoots/part_8/p8_task_1.PNG)

Задание 8.2
##### Добавить автостарт службы при загрузке системы.  
- Добавляю автостарт службы при загрузке системы через команду `sudo systemctl enable ssh`


![sshd](screenshoots/part_8/p8_task_2_1.PNG)
- Проверяю активен ли автостарт для sshd через команду  `sudo systemctl status ssh`


![status sshd](screenshoots/part_8/p8_task_2_2.PNG)

Задание 8.3
##### Перенастроить службу SSHd на порт 2022.  
- Перенастраиваю через редакци файла в nano

![порт на 2022](screenshoots/part_8/p8_task_3_1.PNG)

- Перезапускаю

![порт на 2022](screenshoots/part_8/p8_task_3_2.PNG)

- Проверяю через `sudo netstat -tupln | grep ssh`

![порт на 2022](screenshoots/part_8/p8_task_3_3.PNG)

Задание 8.4
##### Используя команду ps, показать наличие процесса sshd. Для этого к команде нужно подобрать ключи.
- Использую команду `ps aux | grep sshd` для вывода процесса sshd.


![ps](screenshoots/part_8/p8_task_4.PNG)

Команда ps (Process Status) используется для вывода информации о текущих процессах, запущенных на компьютере. Параметры aux команды ps используются для вывода списка всех процессов на компьютере, процессы всех пользователей и вывод всей подробной информации о каждом процессе.
"pc aux grep" часто используется для поиска конкретного процесса или информации о процессах с помощью фильтрации вывода команды ps aux.

- Перезагружаю машину и использую команду `netstat -tan`


![ps](screenshoots/part_8/p8_task_4_1.PNG)

Команда netstat -tan используется для вывода сетевой статистики и информации о сетевых соединениях.
Команда netstat предоставляет информацию о сети, сетевых интерфейсах и сетевых соединениях на компьютере.
-tan :
  t: Параметр t  отображает только TCP-соединения.
  a: Параметр a указывает на вывод всех активных соединений, включая прослушивающие порты.
  n: Параметр n используется для отображения числовых значений IP-адресов и портов вместо их имен.
Команда netstat -tan выводит информацию о всех активных TCP-соединениях на компьютере, отображая числовые значения IP-адресов и портов.

- Значение 0000 в столбце "Foreign Address" указывает на то, что соединение находится в режиме ожидания входящего подключения от любого удаленного адреса.

## Part 9. Установка и использование утилит **top**, **htop**
Задание 9.1
##### Установить и запустить утилиты top и htop.  
- утилита top была установлена по умолчанию, устанавливаю утилиту htop


![htop](screenshoots/part_9/p9_task_1_1.PNG)


##### uptime: 32 min
##### количество авторизованных пользователей: 1 user
##### загрузка cpu: выделено зеленым
##### загрузка памяти: выделено синим


![top](screenshoots/part_9/p9_task_1_2.PNG)

-Через функцию Filter (F4)  в htop нахожу:
  - pid процесса занимающего больше всего памяти


  ![top](screenshoots/part_9/p9_task_1_3.PNG)

  - pid процесса, занимающего больше всего процессорного времени

- В отчёт вставить скрин с выводом команды htop:
  - отсортированному по PID, PERCENT_CPU, PERCENT_MEM, TIME
  PID:


  ![top](screenshoots/part_9/p9_task_1_3.PNG)

  PERCENT_CPU (через F6):


  ![top](screenshoots/part_9/p9_task_1_4_cpu.PNG)

  TIME:
  - Сортировка по времени


  ![top](screenshoots/part_9/p9_task_1_4_1_time.PNG)
  
  - Через клавишу F3 фильтрую для отображения процесса sshd (выделено желтым)


  ![top](screenshoots/part_9/p9_task_1_5_sshd.PNG)

  - Через поиск (f3) нахожу процесс syslog (выделено желтым)


  ![top](screenshoots/part_9/p9_task_1_6_syslog.PNG)

  - Через setup (f2) добавляю hostname, clock и uptime


  ![top](screenshoots/part_9/p9_task_1_7.PNG)


## Part 10. Использование утилиты **fdisk**
Задание 10.1

- Запускаю команду `fdisk -l`
Название диска: выделено желтым
Размер: выделено фиолетовым
Количество секторов: выделено красным


![top](screenshoots/part_10/p10_task_1.PNG)

Размер swap: определяю через команду `swapon -s`


![top](screenshoots/part_10/p10_task_1_2.PNG)

Файл подкачки (swap) представляет собой специальное пространство на жестком диске, которое используется операционной системой в случае нехватки оперативной памяти (RAM). Когда оперативная память заполнена, операционная система начинает использовать файл подкачки для временного хранения данных, которые не помещаются в оперативную память.

## Part 11. Использование утилиты **df** 

Задание 11.1
- Запускаю команду `df /` для корневого раздела (/):
Выделено на скрине: 
##### размер раздела: желтый
##### размер занятого пространства: красный
##### размер свободного пространства: фиолетовый
##### процент использования: зеленый


![top](screenshoots/part_11/p11_task_1_1.PNG)


##### Запустить команду df -Th.
- Для возможности чтения человеком вывожу через команду `df -Th /`. Единицы измерения: гигабайты


![top](screenshoots/part_11/p11_task_1_2.PNG)

Выделено на скрине:
  размер раздела: желтый
  размер занятого пространства: красный
  размер свободного пространства: фиолетовый
  процент использования: зеленый

- Тип файловой системы: ext4 (выделено синим)

## Part 12. Использование утилиты **du**
Задание 12.1
- Запускаю команду `du`
- Запускаю команду `du -h` для читаемого вида


![top](screenshoots/part_12/p12_task_1_1.PNG)

Задание 12.2 
Вывожу размеры папок /home, /var, /var/log (в байтах, в человекочитаемом виде)


![top](screenshoots/part_12/p12_task_2_1.PNG)
![top](screenshoots/part_12/p12_task_2_2.PNG)
![top](screenshoots/part_12/p12_task_2_3.PNG)

Задание 12.3 
- Вывожу размер всего содержимого в /var/log (не общее, а каждого вложенного элемента, используя *)


![top](screenshoots/part_12/p12_task_3_1.PNG)


## Part 13. Установка и использование утилиты **ncdu**
Задание 13.1 
- Устанавливаю утилиту ncdu через команду `sudo apt install ncdu`


![top](screenshoots/part_13/p13_task_1.PNG)

- Вывожу размер папок /home, /var, /var/log
home:


![top](screenshoots/part_13/p13_task_1_1.PNG)

/var:


![top](screenshoots/part_13/p13_task_1_2.PNG)

/var/log:


![top](screenshoots/part_13/p13_task_1_3.PNG)

## Part 14. Работа с системными журналами
Задание 14.1
- Открываю папку чтобы посмотреть что там есть dmesg


![top](screenshoots/part_14/p14_task_1.PNG)

- Открываю syslog


![top](screenshoots/part_14/p14_task_1_2.PNG)

- Открываю auth log


![top](screenshoots/part_14/p14_task_1_3.PNG)
 
- Время последней авторизации: (на скрине)


![top](screenshoots/part_14/p14_task_2.PNG)

- Перезапускаю службу SSHd.


![top](screenshoots/part_14/p14_task_3.PNG)

- Показываю историю в логах


![top](screenshoots/part_14/p14_task_1_4.PNG)

## Part 15. Использование планировщика заданий **CRON**

Задание 15.1
- Вызываю `crontab -l` через nano
- Пишу задание о выводе времени


![top](screenshoots/part_15/p15_task_1.PNG)

Задание 15.2
- Запуск команды uptime через 2 минуты


![top](screenshoots/part_15/p15_task_3.PNG)

- Текущие задания 


![top](screenshoots/part_15/p15_task_2.PNG)

- Вставить в отчёт скрины со строчками о выполнении и списком текущих задач.


![top](screenshoots/part_15/p15_task_4.PNG)

- Удалила все задачи для CRON


![top](screenshoots/part_15/p15_task_5.PNG)